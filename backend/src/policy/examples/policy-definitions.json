[
  {
    "name": "Allow Admin Full Access",
    "description": "Administrators have full access to all API endpoints",
    "type": "api_access",
    "effect": "allow",
    "priority": 100,
    "conditions": {
      "role": "admin"
    },
    "actions": ["*"],
    "resources": ["/api/*"],
    "isActive": true
  },
  {
    "name": "Allow User Read Access",
    "description": "Regular users can read their own data",
    "type": "api_access",
    "effect": "allow",
    "priority": 50,
    "conditions": {
      "role": "user"
    },
    "actions": ["read", "list"],
    "resources": ["/api/users/me", "/api/profile"],
    "isActive": true
  },
  {
    "name": "Deny User Delete Operations",
    "description": "Regular users cannot delete any resources",
    "type": "api_access",
    "effect": "deny",
    "priority": 200,
    "conditions": {
      "role": "user"
    },
    "actions": ["delete"],
    "resources": ["/api/*"],
    "isActive": true
  },
  {
    "name": "Allow Auditor Read-Only Access",
    "description": "Auditors have read-only access to logs and audit trails",
    "type": "api_access",
    "effect": "allow",
    "priority": 75,
    "conditions": {
      "role": "auditor"
    },
    "actions": ["read", "list"],
    "resources": ["/api/audit/*", "/api/logs/*", "/api/policy/audit/logs"],
    "isActive": true
  },
  {
    "name": "Auto Restart Failed Services",
    "description": "Automatically restart services that have failed health checks",
    "type": "self_healing",
    "effect": "allow",
    "priority": 100,
    "conditions": {
      "metadata": {
        "healthStatus": "unhealthy",
        "failureCount": 3
      }
    },
    "actions": ["restart", "notify"],
    "resources": ["service:*"],
    "isActive": true
  },
  {
    "name": "Scale Up on High Load",
    "description": "Scale up services when CPU usage exceeds threshold",
    "type": "self_healing",
    "effect": "allow",
    "priority": 90,
    "conditions": {
      "metadata": {
        "cpuUsage": 80,
        "duration": 300
      }
    },
    "actions": ["scale_up", "alert"],
    "resources": ["service:api", "service:worker"],
    "isActive": true
  },
  {
    "name": "Restrict PII Access",
    "description": "Only admins and auditors can access PII data",
    "type": "data_access",
    "effect": "allow",
    "priority": 150,
    "conditions": {
      "roles": ["admin", "auditor"]
    },
    "actions": ["read", "export"],
    "resources": ["data:pii:*", "table:users:email", "table:users:phone"],
    "isActive": true
  },
  {
    "name": "Emergency Lockdown",
    "description": "Deny all non-admin access during security incidents",
    "type": "api_access",
    "effect": "deny",
    "priority": 1000,
    "conditions": {
      "metadata": {
        "emergencyMode": true
      },
      "role": "user"
    },
    "actions": ["*"],
    "resources": ["/api/*"],
    "isActive": false
  }
]
